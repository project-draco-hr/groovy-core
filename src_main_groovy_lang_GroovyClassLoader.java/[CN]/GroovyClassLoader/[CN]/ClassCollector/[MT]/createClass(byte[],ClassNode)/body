{
  GroovyClassLoader cl=getDefiningClassLoader();
  Class theClass=cl.defineClass(classNode.getName(),code,0,code.length,unit.getAST().getCodeSource());
  cl.resolveClass(theClass);
  this.loadedClasses.add(theClass);
  if (generatedClass == null) {
    ModuleNode mn=classNode.getModule();
    SourceUnit msu=null;
    if (mn != null)     msu=mn.getContext();
    ClassNode main=null;
    if (mn != null)     main=(ClassNode)mn.getClasses().get(0);
    if (msu == su && main == classNode)     generatedClass=theClass;
  }
  return theClass;
}
