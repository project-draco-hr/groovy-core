{
  Script script=null;
  if (scriptClass == null) {
    script=new Script(){
      public Object run(){
        return null;
      }
    }
;
  }
 else {
    try {
      final GroovyObject object=(GroovyObject)scriptClass.newInstance();
      if (object instanceof Script) {
        script=(Script)object;
      }
 else {
        script=new Script(){
          public Object run(){
            Object args=getBinding().getVariables().get("args");
            Object argsToPass=EMPTY_MAIN_ARGS;
            if (args != null && args instanceof String[]) {
              argsToPass=args;
            }
            object.invokeMethod("main",argsToPass);
            return null;
          }
        }
;
        Map variables=context.getVariables();
        MetaClass mc=getMetaClass(object);
        for (        Object o : variables.entrySet()) {
          Map.Entry entry=(Map.Entry)o;
          String key=entry.getKey().toString();
          setPropertySafe(key.startsWith("_") ? script : object,mc,key,entry.getValue());
        }
      }
    }
 catch (    Exception e) {
      throw new GroovyRuntimeException("Failed to create Script instance for class: " + scriptClass + ". Reason: "+ e,e);
    }
  }
  script.setBinding(context);
  return script;
}
