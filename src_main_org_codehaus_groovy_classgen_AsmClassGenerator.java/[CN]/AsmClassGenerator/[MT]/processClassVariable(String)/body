{
  if (passingParams && isInScriptBody()) {
    mv.visitTypeInsn(NEW,"org/codehaus/groovy/runtime/ScriptReference");
    mv.visitInsn(DUP);
    loadThisOrOwner();
    mv.visitLdcInsn(name);
    mv.visitMethodInsn(INVOKESPECIAL,"org/codehaus/groovy/runtime/ScriptReference","<init>","(Lgroovy/lang/Script;Ljava/lang/String;)V");
  }
 else {
    PropertyExpression pexp=new PropertyExpression(VariableExpression.THIS_EXPRESSION,name);
    pexp.setImplicitThis(true);
    visitPropertyExpression(pexp);
  }
}
