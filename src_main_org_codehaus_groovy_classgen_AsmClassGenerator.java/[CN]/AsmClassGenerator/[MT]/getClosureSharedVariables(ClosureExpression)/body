{
  VariableScope scope=ce.getVariableScope();
  Map references=scope.getReferencedLocalVariables();
  Parameter[] ret=new Parameter[references.size()];
  int index=0;
  for (Iterator iter=references.values().iterator(); iter.hasNext(); ) {
    org.codehaus.groovy.ast.Variable element=(org.codehaus.groovy.ast.Variable)iter.next();
    if (element instanceof Parameter) {
      ret[index]=(Parameter)element;
    }
 else {
      Parameter p=new Parameter(element.getType(),element.getName());
      ret[index]=p;
    }
    index++;
  }
  return ret;
}
