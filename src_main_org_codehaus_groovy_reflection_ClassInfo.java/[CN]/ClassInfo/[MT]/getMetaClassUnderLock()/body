{
  MetaClass answer=getStrongMetaClass();
  if (answer != null)   return answer;
  answer=getWeakMetaClass();
  final MetaClassRegistry metaClassRegistry=GroovySystem.getMetaClassRegistry();
  MetaClassRegistry.MetaClassCreationHandle mccHandle=metaClassRegistry.getMetaClassCreationHandler();
  if (answer != null) {
    boolean enableGloballyOn=(mccHandle instanceof ExpandoMetaClassCreationHandle);
    boolean cachedAnswerIsEMC=(answer instanceof ExpandoMetaClass);
    if (!enableGloballyOn || cachedAnswerIsEMC) {
      return answer;
    }
  }
  answer=mccHandle.create(get(),metaClassRegistry);
  answer.initialize();
  if (GroovySystem.isKeepJavaMetaClasses()) {
    setStrongMetaClass(answer);
  }
 else {
    setWeakMetaClass(answer);
  }
  return answer;
}
