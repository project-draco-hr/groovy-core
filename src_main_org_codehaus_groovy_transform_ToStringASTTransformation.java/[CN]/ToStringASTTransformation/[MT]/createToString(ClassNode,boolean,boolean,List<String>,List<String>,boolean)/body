{
  boolean hasExistingToString=hasDeclaredMethod(cNode,"toString",0);
  if (hasExistingToString && hasDeclaredMethod(cNode,"_toString",0))   return;
  final BlockStatement body=new BlockStatement();
  final VariableExpression localVar=new VariableExpression("$toStringLocalVar");
  body.addStatement(new ExpressionStatement(new DeclarationExpression(localVar,ASSIGN,ConstantExpression.NULL)));
  final VariableExpression localVarFirst=new VariableExpression("$toStringLocalVarFirst");
  body.addStatement(new ExpressionStatement(new DeclarationExpression(localVarFirst,ASSIGN,ConstantExpression.TRUE)));
  final Expression result=new VariableExpression("_result");
  final Expression init=new ConstructorCallExpression(STRINGBUFFER_TYPE,MethodCallExpression.NO_ARGUMENTS);
  body.addStatement(new ExpressionStatement(new DeclarationExpression(result,ASSIGN,init)));
  body.addStatement(append(result,new ConstantExpression(cNode.getName())));
  body.addStatement(append(result,new ConstantExpression("(")));
  List<PropertyNode> pList=getInstanceProperties(cNode);
  for (  PropertyNode pNode : pList) {
    if (shouldSkip(pNode.getName(),excludes,includes))     continue;
    String getterName="get" + Verifier.capitalize(pNode.getName());
    Expression getter=new MethodCallExpression(VariableExpression.THIS_EXPRESSION,getterName,MethodCallExpression.NO_ARGUMENTS);
    assignExpressionToVar(body,localVar,getter);
    appendValue(cNode,body,localVar,result,pNode.getName(),localVarFirst,ignoreNullValues);
  }
  List<FieldNode> fList=new ArrayList<FieldNode>();
  if (includeFields) {
    fList.addAll(getInstanceNonPropertyFields(cNode));
  }
  for (  FieldNode fNode : fList) {
    if (shouldSkip(fNode.getName(),excludes,includes))     continue;
    assignExpressionToVar(body,localVar,new VariableExpression(fNode));
    appendValue(cNode,body,localVar,result,fNode.getName(),localVarFirst,ignoreNullValues);
  }
  if (includeSuper) {
    appendCommaIfNotFirst(result,localVarFirst,body);
    appendPrefix(cNode,body,result,"super");
    body.addStatement(append(result,new MethodCallExpression(VariableExpression.SUPER_EXPRESSION,"toString",MethodCallExpression.NO_ARGUMENTS)));
  }
  body.addStatement(append(result,new ConstantExpression(")")));
  body.addStatement(new ReturnStatement(new MethodCallExpression(result,"toString",ArgumentListExpression.EMPTY_ARGUMENTS)));
  cNode.addMethod(new MethodNode(hasExistingToString ? "_toString" : "toString",hasExistingToString ? ACC_PRIVATE : ACC_PUBLIC,ClassHelper.STRING_TYPE,Parameter.EMPTY_ARRAY,ClassNode.EMPTY_ARRAY,body));
}
