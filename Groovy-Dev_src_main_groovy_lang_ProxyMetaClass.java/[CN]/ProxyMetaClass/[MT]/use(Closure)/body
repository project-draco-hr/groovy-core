{
  MetaClass origMetaClass=registry.getMetaClass(theClass);
  registry.setMetaClass(theClass,this);
  try {
    closure.call();
  }
  finally {
    registry.setMetaClass(theClass,origMetaClass);
  }
}
