{
  if (isArrayAccessExpression(expr) || expr instanceof PropertyExpression || (expr instanceof VariableExpression && ((VariableExpression)expr).getAccessedVariable() instanceof DynamicVariable)) {
    return type;
  }
 else   if (expr instanceof VariableExpression && isPrimitiveType(((VariableExpression)expr).getOriginType())) {
    return type;
  }
 else {
    return expr.getType().redirect();
  }
}
