{
  if (elementName.startsWith("@")) {
    return this.attributes.get(elementName.substring(1));
  }
 else {
    final int indexOfFirst=getNextXmlElement(elementName,-1);
    if (indexOfFirst == -1) {
      return new ElementCollection(){
        protected ElementCollection getResult(        final String property){
          return this;
        }
        /** 
 * Used by the Invoker when it wants to iterate over this object
 * @return
 */
        public NameIterator iterator(){
          return new ElementIterator(new XmlList[]{XmlList.this},new int[]{-1}){
{
              findNextChild();
            }
            public void findNextChild(){
              this.nextParentElements[0]=-1;
            }
          }
;
        }
      }
;
    }
    if (getNextXmlElement(elementName,indexOfFirst) == -1) {
      return this.children[indexOfFirst];
    }
 else {
      return new ElementCollection(){
        protected ElementCollection getResult(        final String property){
          if (property.startsWith("@")) {
            return new AttributeCollection(this,property.substring(1));
          }
 else {
            return new ComplexElementCollection(new XmlList[]{XmlList.this},new int[]{indexOfFirst},new String[]{elementName},property);
          }
        }
        /** 
 * Used by the Invoker when it wants to iterate over this object
 * @return
 */
        public NameIterator iterator(){
          return new ElementIterator(new XmlList[]{XmlList.this},new int[]{indexOfFirst}){
            public void findNextChild(){
              this.nextParentElements[0]=XmlList.this.getNextXmlElement(elementName,this.nextParentElements[0]);
            }
          }
;
        }
      }
;
    }
  }
}
