{
  if (str.length() == 0)   return new String[0];
  LinkedList tokens=new LinkedList();
  StringBuffer buffer=new StringBuffer(str);
  int pos=0;
  boolean didReadWhiteSpaceOnly=true;
  int tokenStart=0;
  while (true) {
    if (pos == buffer.length()) {
      if (!didReadWhiteSpaceOnly) {
        tokens.add(buffer.substring(tokenStart));
      }
      break;
    }
    char current=buffer.charAt(pos);
    if (current == ' ') {
      if (!didReadWhiteSpaceOnly) {
        tokens.add(buffer.substring(tokenStart,pos));
        didReadWhiteSpaceOnly=true;
      }
      pos=parseWhiteSpace(buffer,pos);
      tokenStart=pos;
    }
 else     if (current == '\'') {
      didReadWhiteSpaceOnly=false;
      pos=parseString(buffer,pos,"\'");
    }
 else     if (current == '\"') {
      didReadWhiteSpaceOnly=false;
      pos=parseString(buffer,pos,"\"");
    }
 else {
      didReadWhiteSpaceOnly=false;
      pos++;
    }
  }
  return (String[])tokens.toArray(new String[0]);
}
