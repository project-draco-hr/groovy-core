{
  if (append) {
    return new EncodingAwareBufferedWriter(new OutputStreamWriter(new FileOutputStream(file,append),charset));
  }
 else {
    FileOutputStream stream=new FileOutputStream(file);
    if ("UTF-16BE".equals(charset)) {
      writeUtf16Bom(stream,true);
    }
 else     if ("UTF-16LE".equals(charset)) {
      writeUtf16Bom(stream,false);
    }
    return new EncodingAwareBufferedWriter(new OutputStreamWriter(stream,charset));
  }
}
