{
  Class<T> componentType=(Class<T>)self.getClass().getComponentType();
  if (self.length == 0 || num <= 0) {
    return (T[])Array.newInstance(componentType,0);
  }
  if (self.length <= num) {
    T[] ret=(T[])Array.newInstance(componentType,self.length);
    System.arraycopy(self,0,ret,0,self.length);
    return ret;
  }
  T[] ret=(T[])Array.newInstance(componentType,num);
  System.arraycopy(self,0,ret,0,num);
  return ret;
}
