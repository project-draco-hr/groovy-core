{
  if (useNewParser) {
    Class type=null;
    String name="org.codehaus.groovy.antlr.AntlrParserPluginFactory";
    try {
      type=Class.forName(name);
    }
 catch (    ClassNotFoundException e) {
      try {
        type=Thread.currentThread().getContextClassLoader().loadClass(name);
      }
 catch (      ClassNotFoundException e1) {
        try {
          type=ParserPluginFactory.class.getClassLoader().loadClass(name);
        }
 catch (        ClassNotFoundException e2) {
        }
      }
    }
    if (type != null) {
      try {
        return (ParserPluginFactory)type.newInstance();
      }
 catch (      Exception e) {
        throw new RuntimeException("Could not create AntlrParserPluginFactory: " + e,e);
      }
    }
  }
  return new ClassicParserPluginFactory();
}
