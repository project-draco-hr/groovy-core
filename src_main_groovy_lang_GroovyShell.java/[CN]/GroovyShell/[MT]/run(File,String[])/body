{
  String scriptName=scriptFile.getName();
  int p=scriptName.lastIndexOf(".");
  if (p++ >= 0) {
    if (scriptName.substring(p).equals("java")) {
      System.err.println("error: cannot dompile file with .java extension: " + scriptName);
      throw new CompilationFailedException(0,null);
    }
  }
  final Thread thread=Thread.currentThread();
  ClassLoader currentClassLoader=thread.getContextClassLoader();
class DoSetContext implements PrivilegedAction {
    ClassLoader classLoader;
    public DoSetContext(    ClassLoader loader){
      classLoader=loader;
    }
    public Object run(){
      thread.setContextClassLoader(classLoader);
      return null;
    }
  }
  ;
  AccessController.doPrivileged(new DoSetContext(loader));
  Class scriptClass;
  try {
    scriptClass=(Class)AccessController.doPrivileged(new PrivilegedExceptionAction(){
      public Object run() throws CompilationFailedException, IOException {
        return loader.parseClass(scriptFile);
      }
    }
);
  }
 catch (  PrivilegedActionException pae) {
    Exception e=pae.getException();
    if (e instanceof CompilationFailedException) {
      throw (CompilationFailedException)e;
    }
 else     if (e instanceof IOException) {
      throw (IOException)e;
    }
 else {
      throw (RuntimeException)pae.getException();
    }
  }
  runMainOrTestOrRunnable(scriptClass,args);
  AccessController.doPrivileged(new DoSetContext(currentClassLoader));
}
