{
  boolean itlp=isTopLevelProperty;
  boolean ipe=inPropertyExpression;
  Expression objectExpression=pe.getObjectExpression();
  inPropertyExpression=true;
  isTopLevelProperty=!(objectExpression.getClass() == PropertyExpression.class);
  objectExpression=transform(objectExpression);
  inPropertyExpression=false;
  Expression property=transform(pe.getProperty());
  isTopLevelProperty=itlp;
  inPropertyExpression=ipe;
  boolean spreadSafe=pe.isSpreadSafe();
  pe=new PropertyExpression(objectExpression,property,pe.isSafe());
  pe.setSpreadSafe(spreadSafe);
  String className=lookupClassName(pe);
  if (className != null) {
    ClassNode type=ClassHelper.make(className);
    if (resolve(type))     return new ClassExpression(type);
  }
  if (objectExpression instanceof ClassExpression && pe.getPropertyAsString() != null) {
    ClassExpression ce=(ClassExpression)objectExpression;
    ClassNode type=ClassHelper.make(ce.getType().getName() + "$" + pe.getPropertyAsString());
    if (resolve(type,false,false,false))     return new ClassExpression(type);
  }
  Expression ret=pe;
  if (isTopLevelProperty) {
    checkStaticScope(pe);
    ret=correctClassClassChain(pe);
  }
  return ret;
}
