{
  this.classNode=node;
  node.addInterface(GroovyObject.class.getName());
  PropertyNode metaClassProperty=node.addProperty("metaClass",ACC_PUBLIC,MetaClass.class.getName(),new StaticMethodCallExpression(InvokerHelper.class.getName(),"getMetaClass",new VariableExpression("this")),null,null);
  FieldNode metaClassField=metaClassProperty.getField();
  boolean addDelegateObject=node instanceof InnerClassNode && node.getSuperClass().equals("groovy.lang.Closure");
  if (!addDelegateObject) {
    node.addMethod("invokeMethod",ACC_PUBLIC,Object.class.getName(),new Parameter[]{new Parameter(String.class.getName(),"method"),new Parameter(Object.class.getName(),"arguments")},new ReturnStatement(new MethodCallExpression(new FieldExpression(metaClassField),"invokeMethod",new ArgumentListExpression(new Expression[]{new VariableExpression("this"),new VariableExpression("method"),new VariableExpression("arguments")}))));
    if (!node.getSuperClass().equals(Script.class.getName())) {
      node.addMethod("getProperty",ACC_PUBLIC,Object.class.getName(),new Parameter[]{new Parameter(String.class.getName(),"property")},new ReturnStatement(new MethodCallExpression(new FieldExpression(metaClassField),"getProperty",new ArgumentListExpression(new Expression[]{new VariableExpression("this"),new VariableExpression("property")}))));
      node.addMethod("setProperty",ACC_PUBLIC,"void",new Parameter[]{new Parameter(String.class.getName(),"property"),new Parameter(Object.class.getName(),"value")},new ExpressionStatement(new MethodCallExpression(new FieldExpression(metaClassField),"setProperty",new ArgumentListExpression(new Expression[]{new VariableExpression("this"),new VariableExpression("property"),new VariableExpression("value")}))));
    }
  }
  if (node.getConstructors().isEmpty()) {
    node.addConstructor(new ConstructorNode(ACC_PUBLIC,null));
  }
  addFieldInitialization(node);
  node.visitContents(this);
}
