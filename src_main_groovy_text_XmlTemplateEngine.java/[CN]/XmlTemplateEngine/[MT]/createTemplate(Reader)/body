{
  Node root=null;
  try {
    root=xmlParser.parse(reader);
  }
 catch (  SAXException e) {
    throw new RuntimeException("Parsing XML source failed.",e);
  }
  if (root == null) {
    throw new IOException("Parsing XML source failed: root node is null.");
  }
  StringWriter writer=new StringWriter(1024);
  writer.write("/* Generated by XmlTemplateEngine */\n");
  new GspPrinter(new PrintWriter(writer),indentation).print(root);
  Script script=groovyShell.parse(writer.toString());
  return new XmlTemplate(script);
}
