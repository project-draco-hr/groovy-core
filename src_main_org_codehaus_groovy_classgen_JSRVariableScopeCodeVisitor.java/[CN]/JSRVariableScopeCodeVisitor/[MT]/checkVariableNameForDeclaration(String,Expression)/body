{
  Variable var=new Var(name,currentScope);
  if ("super".equals(var.getName()) || "this".equals(var.getName()))   return null;
  VarScope scope=currentScope;
  while (scope != null) {
    if (scope.declares.get(var.getName()) != null) {
      var=(Variable)scope.declares.get(var.getName());
      break;
    }
    if (scope.visibles.get(var.getName()) != null) {
      var=(Variable)scope.visibles.get(var.getName());
      break;
    }
    scope=scope.parent;
  }
  VarScope end=scope;
  if (scope == null) {
    ClassNode vn=unit.getClass(var.getName());
    if (vn == null) {
      declare(var,expression);
      if (!scriptMode)       addError("The variable " + var.getName() + " is undefined in the current scope",expression);
    }
  }
 else {
    scope=currentScope;
    while (scope != end) {
      scope.visibles.put(var.getName(),var);
      scope=scope.parent;
    }
  }
  return var;
}
