{
  StringBuffer buffer=new StringBuffer("insert into ");
  buffer.append(table);
  buffer.append(" (");
  StringBuffer paramBuffer=new StringBuffer();
  boolean first=true;
  for (  String column : map.keySet()) {
    if (first) {
      first=false;
      paramBuffer.append("?");
    }
 else {
      buffer.append(", ");
      paramBuffer.append(", ?");
    }
    buffer.append(column);
  }
  buffer.append(") values (");
  buffer.append(paramBuffer.toString());
  buffer.append(")");
  Connection connection=createConnection();
  PreparedStatement statement=null;
  try {
    statement=connection.prepareStatement(buffer.toString());
    int i=1;
    for (    Object value : map.values()) {
      setObject(statement,i++,value);
    }
    int answer=statement.executeUpdate();
    if (answer != 1) {
      log.log(Level.WARNING,"Should have updated 1 row not " + answer + " when trying to add: "+ map);
    }
  }
 catch (  SQLException e) {
    log.log(Level.WARNING,"Failed to add row for: " + map,e);
    throw e;
  }
 finally {
    closeResources(connection,statement);
  }
}
