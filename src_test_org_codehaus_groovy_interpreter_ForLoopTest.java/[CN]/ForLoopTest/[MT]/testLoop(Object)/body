{
  RuntimeContext context=new RuntimeContext();
  context.setVariable("fooCollection",collection);
  DummyBean bean=new DummyBean();
  context.setVariable("bean",bean);
  GroovyCodeVisitor visitor=new Interpreter(context);
  Statement statement=new ExpressionStatement(new MethodCallExpression(new VariableExpression("bean"),"foo",new VariableExpression("i")));
  Expression expression=new VariableExpression("fooCollection");
  ForLoop loop=new ForLoop("i",expression,statement);
  loop.visit(visitor);
  assertEquals("invocations count","ABC",bean.getBuffer());
}
