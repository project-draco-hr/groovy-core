{
  int i=Math.max(0,index - 1);
  StringSection precedingSection=sections.get(i);
  int traceLine=-1;
  for (  StackTraceElement element : e.getStackTrace()) {
    if (element.getClassName().contains(TEMPLATE_SCRIPT_PREFIX)) {
      traceLine=element.getLineNumber();
      break;
    }
  }
  if (traceLine != -1) {
    int actualLine=precedingSection.lastSourcePosition.row + traceLine - 1;
    throw new TemplateExecutionException("Error at line " + actualLine + ", message: "+ e.getMessage(),e);
  }
 else {
    throw e;
  }
}
