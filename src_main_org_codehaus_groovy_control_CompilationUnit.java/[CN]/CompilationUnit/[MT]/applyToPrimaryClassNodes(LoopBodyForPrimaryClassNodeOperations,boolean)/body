{
  boolean failures=false;
  Iterator classNodes=getPrimaryClassNodes(sort).iterator();
  while (classNodes.hasNext()) {
    SourceUnit context=null;
    try {
      ClassNode classNode=(ClassNode)classNodes.next();
      context=classNode.getModule().getContext();
      if (context == null || context.phase <= phase) {
        body.call(context,new GeneratorContext(this.ast),classNode);
      }
    }
 catch (    CompilationFailedException e) {
    }
catch (    NullPointerException npe) {
      throw npe;
    }
catch (    GroovyBugError e) {
      changeBugText(e,context);
      throw e;
    }
catch (    Exception e) {
      failures=true;
      ErrorCollector nestedCollector=null;
      for (Throwable next=e.getCause(); next != e && next != null; next=next.getCause()) {
        if (!(next instanceof MultipleCompilationErrorsException))         continue;
        MultipleCompilationErrorsException mcee=(MultipleCompilationErrorsException)next;
        nestedCollector=mcee.collector;
        break;
      }
      if (nestedCollector != null) {
        getErrorCollector().addCollectorContents(nestedCollector);
      }
 else {
        getErrorCollector().addError(new ExceptionMessage(e,configuration.getDebug(),this));
      }
    }
  }
  getErrorCollector().failIfErrors();
}
