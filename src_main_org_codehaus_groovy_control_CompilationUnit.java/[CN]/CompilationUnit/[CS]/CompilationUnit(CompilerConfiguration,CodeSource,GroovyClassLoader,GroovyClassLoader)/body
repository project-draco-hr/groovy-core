{
  super(configuration,loader,null);
  this.transformLoader=transformLoader;
  this.names=new ArrayList<String>();
  this.queuedSources=new LinkedList<SourceUnit>();
  this.sources=new HashMap<String,SourceUnit>();
  this.summariesBySourceName=new HashMap();
  this.summariesByPublicClassName=new HashMap();
  this.classSourcesByPublicClassName=new HashMap();
  this.ast=new CompileUnit(this.classLoader,security,this.configuration);
  this.generatedClasses=new ArrayList<GroovyClass>();
  this.verifier=new Verifier();
  this.resolveVisitor=new ResolveVisitor(this);
  this.staticImportVisitor=new StaticImportVisitor();
  this.optimizer=new OptimizerVisitor(this);
  phaseOperations=new LinkedList[Phases.ALL + 1];
  newPhaseOperations=new LinkedList[Phases.ALL + 1];
  for (int i=0; i < phaseOperations.length; i++) {
    phaseOperations[i]=new LinkedList();
    newPhaseOperations[i]=new LinkedList();
  }
  addPhaseOperation(new SourceUnitOperation(){
    public void call(    SourceUnit source) throws CompilationFailedException {
      source.parse();
    }
  }
,Phases.PARSING);
  addPhaseOperation(convert,Phases.CONVERSION);
  addPhaseOperation(new PrimaryClassNodeOperation(){
    public void call(    SourceUnit source,    GeneratorContext context,    ClassNode classNode) throws CompilationFailedException {
      EnumVisitor ev=new EnumVisitor(CompilationUnit.this,source);
      ev.visitClass(classNode);
    }
  }
,Phases.CONVERSION);
  addPhaseOperation(resolve,Phases.SEMANTIC_ANALYSIS);
  addPhaseOperation(staticImport,Phases.SEMANTIC_ANALYSIS);
  addPhaseOperation(new PrimaryClassNodeOperation(){
    @Override public void call(    SourceUnit source,    GeneratorContext context,    ClassNode classNode) throws CompilationFailedException {
      InnerClassVisitor iv=new InnerClassVisitor(CompilationUnit.this,source);
      iv.visitClass(classNode);
    }
  }
,Phases.SEMANTIC_ANALYSIS);
  addPhaseOperation(compileCompleteCheck,Phases.CANONICALIZATION);
  addPhaseOperation(classgen,Phases.CLASS_GENERATION);
  addPhaseOperation(output);
  ASTTransformationVisitor.addPhaseOperations(this);
  addPhaseOperation(new PrimaryClassNodeOperation(){
    @Override public void call(    SourceUnit source,    GeneratorContext context,    ClassNode classNode) throws CompilationFailedException {
      StaticVerifier sv=new StaticVerifier();
      sv.visitClass(classNode,source);
    }
  }
,Phases.SEMANTIC_ANALYSIS);
  addPhaseOperation(new PrimaryClassNodeOperation(){
    @Override public void call(    SourceUnit source,    GeneratorContext context,    ClassNode classNode) throws CompilationFailedException {
      InnerClassCompletionVisitor iv=new InnerClassCompletionVisitor(CompilationUnit.this,source);
      iv.visitClass(classNode);
    }
  }
,Phases.CANONICALIZATION);
  this.classgenCallback=null;
}
