{
  if (!GroovyObject.class.isAssignableFrom(theClass))   return;
  final Map mainClassMethodIndex=classMethodIndex.getNotNull(theCachedClass);
class MOPIter extends MethodIndexAction {
    boolean useThis;
    public boolean skipClass(    CachedClass clazz){
      return !useThis && clazz == theCachedClass;
    }
    public void methodListAction(    CachedClass clazz,    String methodName,    MetaMethod method,    List oldList,    List newList){
      String mopName=ReflectionCache.getMOPMethodName(method.getDeclaringClass(),methodName,useThis);
      ArrayList matches=(ArrayList)mainClassMethodIndex.get(mopName);
      if (matches == null) {
        newList.add(method);
        return;
      }
      int matchingMethod=findMatchingMethod(matches,method);
      if (matchingMethod == -1) {
        newList.add(method);
      }
 else {
        newList.add(matches.get(matchingMethod));
      }
    }
  }
  MOPIter iter=new MOPIter();
  iter.useThis=false;
  iter.iterate(classMethodIndexForSuper);
  iter.useThis=true;
  iter.iterate(classMethodIndex);
}
