{
  ThreadLocal<CompilationUnit> localCu=getLocalCompilationUnit();
  ThreadLocal<StringSetMap> localCache=getDepCache();
  ScriptCacheEntry origEntry=scriptCache.get(codeSource.getName());
  Set<String> origDep=null;
  if (origEntry != null)   origDep=origEntry.dependencies;
  if (origDep != null)   localCache.get().put(".",origDep);
  Class answer=super.parseClass(codeSource,false);
  StringSetMap cache=localCache.get();
  cache.makeTransitiveHull();
  long now=System.currentTimeMillis();
  Set<String> entryNames=new HashSet<String>();
  for (  Map.Entry<String,Set<String>> entry : cache.entrySet()) {
    String className=entry.getKey();
    Class clazz=getClassCacheEntry(className);
    if (clazz == null)     continue;
    String entryName=getPath(clazz);
    if (entryNames.contains(entryName))     continue;
    entryNames.add(entryName);
    Set<String> value=convertToPaths(entry.getValue());
    ScriptCacheEntry cacheEntry=new ScriptCacheEntry(clazz,now,value);
    scriptCache.put(entryName,cacheEntry);
  }
  cache.clear();
  localCu.set(null);
  return answer;
}
