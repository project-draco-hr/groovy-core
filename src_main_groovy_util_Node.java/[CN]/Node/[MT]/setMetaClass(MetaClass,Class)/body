{
  final MetaClass newMetaClass=new DelegatingMetaClass(metaClass){
    public Object getAttribute(    final Object object,    final String attribute){
      Node n=(Node)object;
      return n.get("@" + attribute);
    }
    public void setAttribute(    final Object object,    final String attribute,    final Object newValue){
      Node n=(Node)object;
      n.attributes().put(attribute,newValue);
    }
    public Object getProperty(    Object object,    String property){
      if (object instanceof Node) {
        Node n=(Node)object;
        return n.get(property);
      }
      return super.getProperty(object,property);
    }
    public void setProperty(    Object object,    String property,    Object newValue){
      if (property.startsWith("@")) {
        String attribute=property.substring(1);
        Node n=(Node)object;
        n.attributes().put(attribute,newValue);
        return;
      }
      delegate.setProperty(object,property,newValue);
    }
  }
;
  GroovySystem.getMetaClassRegistry().setMetaClass(nodeClass,newMetaClass);
}
