{
  ArrayList ret=new ArrayList();
  int argsPos=0;
  int spreadPos=0;
  for (int pos=0; pos < positions.length; pos++) {
    for (; argsPos < positions[pos]; argsPos++) {
      ret.add(args[argsPos]);
    }
    Object value=spreads[spreadPos];
    if (!(value instanceof List))     throw new IllegalArgumentException("connot spread the type " + value.getClass().getName() + " with value "+ value);
    ret.addAll((List)value);
    spreadPos++;
  }
  for (; argsPos < args.length; argsPos++) {
    ret.add(args[argsPos]);
  }
  return ret.toArray();
}
