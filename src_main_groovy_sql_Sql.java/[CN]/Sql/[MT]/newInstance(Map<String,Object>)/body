{
  if (args.containsKey("driverClassName") && args.containsKey("driver"))   throw new IllegalArgumentException("Only one of 'driverClassName' and 'driver' should be provided");
  String driverClassName=(String)args.remove("driverClassName");
  if (driverClassName == null)   driverClassName=(String)args.remove("driver");
  if (driverClassName != null)   loadDriver(driverClassName);
  String url=(String)args.remove("url");
  if (url == null)   throw new IllegalArgumentException("Argument 'url' is required");
  Properties props=(Properties)args.remove("properties");
  if (props != null && args.containsKey("user"))   throw new IllegalArgumentException("Only one of 'properties' and 'user' should be supplied");
  if (props != null && args.containsKey("password"))   throw new IllegalArgumentException("Only one of 'properties' and 'password' should be supplied");
  if (args.containsKey("user") ^ args.containsKey("password"))   throw new IllegalArgumentException("Found one but not both of 'user' and 'password'");
  Connection connection;
  if (props != null)   connection=DriverManager.getConnection(url,props);
 else   if (args.containsKey("user"))   connection=DriverManager.getConnection(url,(String)args.remove("user"),(String)args.remove("password"));
 else   connection=DriverManager.getConnection(url);
  Sql result=(Sql)InvokerHelper.invokeConstructorOf(Sql.class,args);
  result.setConnection(connection);
  return result;
}
