{
  if (isCacheStatements() && useConnection != null) {
    return useConnection;
  }
  if (dataSource != null) {
    Connection con=null;
    try {
      con=(Connection)AccessController.doPrivileged(new PrivilegedExceptionAction(){
        public Object run() throws SQLException {
          return dataSource.getConnection();
        }
      }
);
    }
 catch (    PrivilegedActionException pae) {
      Exception e=pae.getException();
      if (e instanceof SQLException) {
        throw (SQLException)e;
      }
 else {
        throw (RuntimeException)e;
      }
    }
    if (isCacheStatements()) {
      useConnection=con;
    }
    return con;
  }
 else {
    return useConnection;
  }
}
