{
  String pattern=servletContext.getInitParameter("groovy.servlet.resource.pattern");
  String replace=servletContext.getInitParameter("groovy.servlet.resource.replace");
  if (pattern != null && replace != null) {
    name=name.replaceAll(pattern,replace);
    log("replaced resource name to \"" + name + "\"");
  }
 else {
    log("init parms null: groovy.servlet.resource.pattern, groovy.servlet.resource.replace");
  }
  try {
    URL url=servletContext.getResource("/" + name);
    if (url == null) {
      url=servletContext.getResource("/WEB-INF/groovy/" + name);
      if (url == null) {
        throw new ResourceException("Resource " + name + " not found");
      }
    }
    return url.openConnection();
  }
 catch (  IOException ioe) {
    throw new ResourceException("Problem reading resource named \"" + name + "\"");
  }
}
