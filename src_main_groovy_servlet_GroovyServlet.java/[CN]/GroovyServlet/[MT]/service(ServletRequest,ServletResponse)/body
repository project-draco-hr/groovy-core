{
  final HttpServletRequest httpRequest=(HttpServletRequest)request;
  final HttpServletResponse httpResponse=(HttpServletResponse)response;
  int contextLength=httpRequest.getContextPath().length();
  String scriptFilename=httpRequest.getRequestURI().substring(contextLength).substring(1);
  Binding binding=new Binding();
  binding.setVariable("request",httpRequest);
  binding.setVariable("response",httpResponse);
  binding.setVariable("application",sc);
  binding.setVariable("session",httpRequest.getSession(true));
  binding.setVariable("out",httpResponse.getWriter());
  for (Enumeration paramEnum=request.getParameterNames(); paramEnum.hasMoreElements(); ) {
    String key=(String)paramEnum.nextElement();
    if (binding.getVariable(key) == null) {
      String[] values=request.getParameterValues(key);
      if (values.length == 1) {
        binding.setVariable(key,values[0]);
      }
 else {
        binding.setVariable(key,values);
      }
    }
  }
  response.setContentType("text/html");
  try {
    gse.run(scriptFilename,binding);
  }
 catch (  ScriptException se) {
    httpResponse.sendError(500);
  }
catch (  ResourceException re) {
    httpResponse.sendError(404);
  }
}
