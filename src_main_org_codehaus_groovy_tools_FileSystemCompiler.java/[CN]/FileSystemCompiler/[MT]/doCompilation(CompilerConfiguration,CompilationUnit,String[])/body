{
  File tmpDir=null;
  try {
    if ((configuration.getJointCompilationOptions() != null) && !configuration.getJointCompilationOptions().containsKey("stubDir")) {
      tmpDir=createTempDir();
      configuration.getJointCompilationOptions().put("stubDir",tmpDir);
    }
    FileSystemCompiler compiler=new FileSystemCompiler(configuration,unit);
    compiler.compile(filenames);
  }
  finally {
    try {
      if (tmpDir != null)       deleteRecursive(tmpDir);
    }
 catch (    Throwable t) {
      System.err.println("error: could not delete temp files - " + tmpDir.getPath());
    }
  }
}
