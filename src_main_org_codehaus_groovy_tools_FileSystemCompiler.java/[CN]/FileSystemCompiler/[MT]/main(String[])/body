{
  boolean displayStackTraceOnError=false;
  boolean jointCompilation;
  try {
    Options options=new Options();
    options.addOption(OptionBuilder.withLongOpt("classpath").hasArg().withArgName("path").withDescription("Specify where to find the class files.").create());
    options.addOption(OptionBuilder.withLongOpt("sourcepath").hasArg().withArgName("path").withDescription("Specify where to find the source files.").create());
    options.addOption(OptionBuilder.withLongOpt("temp").hasArg().withArgName("temp").withDescription("").create());
    options.addOption(OptionBuilder.withLongOpt("encoding").hasArg().withArgName("encoding").withDescription("Specify the encoding of the user class files.").create());
    options.addOption(OptionBuilder.hasArg().withDescription("Specify where to place generated class files.").create('d'));
    options.addOption(OptionBuilder.withLongOpt("help").withDescription("Print a synopsis of standard options.").create('h'));
    options.addOption(OptionBuilder.withLongOpt("version").withDescription("Print the version.").create('v'));
    options.addOption(OptionBuilder.withLongOpt("exception").withDescription("Print stack trace on error.").create('e'));
    options.addOption(OptionBuilder.withLongOpt("jointCompilation").withDescription("Attach javac compiler to compile .java files.").create('j'));
    options.addOption(OptionBuilder.withArgName("property=value").withValueSeparator().hasArgs(2).withDescription("").create("J"));
    options.addOption(OptionBuilder.withArgName("flag").hasArg().withDescription("").create("F"));
    PosixParser cliParser=new PosixParser();
    CommandLine cli=cliParser.parse(options,args);
    if (cli.hasOption('h')) {
      displayHelp(options);
      return;
    }
    if (cli.hasOption('v')) {
      displayVersion();
      return;
    }
    CompilerConfiguration configuration=new CompilerConfiguration();
    if (cli.hasOption("classpath")) {
      configuration.setClasspath(cli.getOptionValue("classpath"));
    }
    if (cli.hasOption('d')) {
      configuration.setTargetDirectory(cli.getOptionValue('d'));
    }
    if (cli.hasOption("encoding")) {
      configuration.setSourceEncoding(cli.getOptionValue("encoding"));
    }
    displayStackTraceOnError=cli.hasOption('e');
    jointCompilation=cli.hasOption('j');
    if (jointCompilation) {
      Map compilerOptions=new HashMap();
      String[] opts=cli.getOptionValues("J");
      compilerOptions.put("namedValues",opts);
      opts=cli.getOptionValues("F");
      compilerOptions.put("flags",opts);
      configuration.setJointCompilationOptions(compilerOptions);
    }
    String[] filenames=cli.getArgs();
    if (filenames.length == 0) {
      displayHelp(options);
      return;
    }
    int errors=checkFiles(filenames);
    if (errors == 0) {
      if (jointCompilation) {
        File tmpDir=createTempDir();
        configuration.getJointCompilationOptions().put("stubDir",tmpDir);
      }
      FileSystemCompiler compiler=new FileSystemCompiler(configuration);
      compiler.compile(filenames);
    }
  }
 catch (  Throwable e) {
    new ErrorReporter(e,displayStackTraceOnError).write(System.err);
  }
}
