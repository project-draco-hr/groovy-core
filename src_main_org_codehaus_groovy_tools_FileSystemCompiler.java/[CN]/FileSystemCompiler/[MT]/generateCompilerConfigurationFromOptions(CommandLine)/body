{
  CompilerConfiguration configuration=new CompilerConfiguration();
  if (cli.hasOption("classpath")) {
    configuration.setClasspath(cli.getOptionValue("classpath"));
  }
  if (cli.hasOption('d')) {
    configuration.setTargetDirectory(cli.getOptionValue('d'));
  }
  if (cli.hasOption("encoding")) {
    configuration.setSourceEncoding(cli.getOptionValue("encoding"));
  }
  if (cli.hasOption("baseScript")) {
    configuration.setScriptBaseClass(cli.getOptionValue("baseScript"));
  }
  if (cli.hasOption('j')) {
    Map<String,Object> compilerOptions=new HashMap<String,Object>();
    String[] opts=cli.getOptionValues("J");
    compilerOptions.put("namedValues",opts);
    opts=cli.getOptionValues("F");
    compilerOptions.put("flags",opts);
    configuration.setJointCompilationOptions(compilerOptions);
  }
  if (cli.hasOption("indy")) {
    configuration.getOptimizationOptions().put("int",false);
    configuration.getOptimizationOptions().put("indy",true);
  }
  return configuration;
}
