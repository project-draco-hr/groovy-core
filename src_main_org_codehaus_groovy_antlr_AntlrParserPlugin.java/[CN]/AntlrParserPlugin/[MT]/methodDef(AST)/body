{
  List annotations=new ArrayList();
  AST node=methodDef.getFirstChild();
  int modifiers=Opcodes.ACC_PUBLIC;
  if (isType(MODIFIERS,node)) {
    modifiers=modifiers(node,annotations,modifiers);
    node=node.getNextSibling();
  }
  if (classNode != null && (classNode.getModifiers() & Opcodes.ACC_INTERFACE) > 0) {
    modifiers|=Opcodes.ACC_ABSTRACT;
  }
  String returnType=null;
  if (isType(TYPE,node)) {
    returnType=typeName(node);
    node=node.getNextSibling();
  }
  String name=identifier(node);
  if (classNode != null) {
    if (classNode.getNameWithoutPackage().equals(name)) {
      throw new ASTRuntimeException(methodDef,"Invalid constructor format. Try remove the 'def' expression?");
    }
  }
  node=node.getNextSibling();
  assertNodeType(PARAMETERS,node);
  Parameter[] parameters=parameters(node);
  node=node.getNextSibling();
  Statement code=null;
  if ((modifiers & Opcodes.ACC_ABSTRACT) == 0) {
    if (node == null) {
      throw new ASTRuntimeException(methodDef,"You defined a method without body. Try adding a body, or declare it abstract.");
    }
    assertNodeType(SLIST,node);
    code=statementList(node);
  }
  MethodNode methodNode=new MethodNode(name,modifiers,returnType,parameters,code);
  methodNode.addAnnotations(annotations);
  configureAST(methodNode,methodDef);
  if (classNode != null) {
    classNode.addMethod(methodNode);
  }
 else {
    output.addMethod(methodNode);
  }
}
