{
  Class[] wrappedArguments=wrap(arguments);
  LinkedList directMatches=new LinkedList();
  for (Iterator iter=matchingMethods.iterator(); iter.hasNext(); ) {
    Object method=iter.next();
    Class[] paramTypes=wrap(getParameterTypes(method));
    if (Arrays.equals(wrappedArguments,paramTypes))     directMatches.add(method);
  }
  if (directMatches.size() == 1)   return directMatches.getFirst();
  if (directMatches.size() > 0) {
    matchingMethods=directMatches;
    directMatches=new LinkedList();
    for (Iterator iter=matchingMethods.iterator(); iter.hasNext(); ) {
      Object method=iter.next();
      Class[] paramTypes=getParameterTypes(method);
      if (Arrays.equals(arguments,paramTypes))       directMatches.add(method);
    }
    if (directMatches.size() == 1)     return directMatches.getFirst();
  }
  List superclassMatches=new ArrayList(matchingMethods);
  for (Iterator iter=superclassMatches.iterator(); iter.hasNext(); ) {
    Object method=iter.next();
    Class[] paramTypes=getParameterTypes(method);
    for (int i=0; i < paramTypes.length; i++) {
      if (!isSuperclass(arguments[i],paramTypes[i])) {
        iter.remove();
        break;
      }
    }
  }
  if (superclassMatches.size() > 0) {
    matchingMethods=superclassMatches;
  }
  Object answer=null;
  int size=arguments.length;
  Class[] mostSpecificTypes=null;
  for (Iterator iter=matchingMethods.iterator(); iter.hasNext(); ) {
    Object method=iter.next();
    Class[] paramTypes=getParameterTypes(method);
    if (answer == null) {
      answer=method;
      mostSpecificTypes=paramTypes;
    }
 else {
      boolean useThisMethod=false;
      for (int i=0; i < size; i++) {
        Class mostSpecificType=mostSpecificTypes[i];
        Class type=paramTypes[i];
        if (!isAssignableFrom(mostSpecificType,type)) {
          useThisMethod=true;
          break;
        }
      }
      if (useThisMethod) {
        if (size > 1) {
          checkForInvalidOverloading(name,mostSpecificTypes,paramTypes);
        }
        answer=method;
        mostSpecificTypes=paramTypes;
      }
    }
  }
  return answer;
}
