{
  PrivilegedActionException firstException=null;
  try {
    try {
      final Class clazz=theClass;
      Field field=(Field)AccessController.doPrivileged(new PrivilegedExceptionAction(){
        public Object run() throws NoSuchFieldException {
          return clazz.getDeclaredField(attribute);
        }
      }
);
      field.setAccessible(true);
      return field.get(object);
    }
 catch (    PrivilegedActionException pae) {
      firstException=pae;
    }
    if (object instanceof Class) {
      try {
        final Class clazz=(Class)object;
        Field field=(Field)AccessController.doPrivileged(new PrivilegedExceptionAction(){
          public Object run() throws NoSuchFieldException {
            return clazz.getDeclaredField(attribute);
          }
        }
);
        field.setAccessible(true);
        return field.get(object);
      }
 catch (      PrivilegedActionException pae) {
        firstException=pae;
      }
    }
    if (firstException.getException() instanceof NoSuchFieldException) {
      throw (NoSuchFieldException)firstException.getException();
    }
 else {
      throw new RuntimeException(firstException.getException());
    }
  }
 catch (  NoSuchFieldException e) {
    throw new MissingFieldException(attribute,theClass);
  }
catch (  IllegalAccessException e) {
    throw new MissingFieldException(attribute,theClass,e);
  }
}
