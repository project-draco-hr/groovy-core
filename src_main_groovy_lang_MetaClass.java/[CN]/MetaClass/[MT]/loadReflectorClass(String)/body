{
  ClassLoader loader=(ClassLoader)AccessController.doPrivileged(new PrivilegedAction(){
    public Object run(){
      return theClass.getClassLoader();
    }
  }
);
  if (loader instanceof GroovyClassLoader) {
    GroovyClassLoader gloader=(GroovyClassLoader)loader;
    return gloader.loadClass(name);
  }
  return registry.loadClass(loader,name);
}
