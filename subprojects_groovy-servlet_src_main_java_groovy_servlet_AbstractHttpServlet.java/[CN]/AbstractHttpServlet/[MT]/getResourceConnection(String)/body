{
  URI uri=new File(servletContext.getRealPath("/")).toURI();
  try {
    String basePath=uri.toURL().toExternalForm();
    if (name.startsWith(basePath))     name=name.substring(basePath.length());
  }
 catch (  MalformedURLException e) {
    throw new ResourceException("Malformed URL for base path '" + uri + "'",e);
  }
  name=name.replaceAll("\\\\","/");
  if (name.startsWith("/"))   name=name.substring(1);
  try {
    String tryScriptName="/" + name;
    URL url=servletContext.getResource(tryScriptName);
    if (url == null) {
      tryScriptName="/WEB-INF/groovy/" + name;
      url=servletContext.getResource("/WEB-INF/groovy/" + name);
    }
    if (url == null) {
      throw new ResourceException("Resource \"" + name + "\" not found!");
    }
 else {
      url=new URL("file","",servletContext.getRealPath(tryScriptName));
    }
    return url.openConnection();
  }
 catch (  IOException e) {
    throw new ResourceException("Problems getting resource named \"" + name + "\"!",e);
  }
}
