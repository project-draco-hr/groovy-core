{
  Map<Integer,ASTAnnotationMacroCodeVisitor> macroVisitors=new HashMap<Integer,ASTAnnotationMacroCodeVisitor>();
  ASTAnnotationMacroCollectorCodeVisitor annotCollector=new ASTAnnotationMacroCollectorCodeVisitor(macroVisitors);
  unit.addPhaseOperation(annotCollector.getOperation(),Phases.SEMANTIC_ANALYSIS);
  for (int i=Phases.SEMANTIC_ANALYSIS; i <= Phases.ALL; i++) {
    ASTAnnotationMacroCodeVisitor macroVisitor=new ASTAnnotationMacroCodeVisitor();
    macroVisitors.put(Integer.valueOf(i),macroVisitor);
    unit.addPhaseOperation(macroVisitor.getOperation(),i);
  }
}
