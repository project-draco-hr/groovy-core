{
  if (object == null) {
    if (!(delegate instanceof ExpandoMetaClass)) {
      delegate=ExpandoMetaClassCreationHandle.instance.create(delegate.getTheClass(),GroovySystem.getMetaClassRegistry());
      delegate.initialize();
      DefaultGroovyMethods.setMetaClass(delegate.getTheClass(),delegate);
    }
  }
 else {
    if (object != NONE) {
      delegate=new ExpandoMetaClass(object.getClass(),false,true);
      delegate.initialize();
      DefaultGroovyMethods.setMetaClass(object,delegate);
      object=NONE;
    }
  }
  return (GroovyObject)delegate;
}
